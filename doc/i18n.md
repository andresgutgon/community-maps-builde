# Internationalization and translation
We use [react-intl](https://formatjs.io/docs/react-intl/) for making the maps multi language. Also we use the standard way in [NextJS of managing locales](https://nextjs.org/docs/advanced-features/i18n-routing)
To create a new translated string you can do in 2 ways in our react components:

### Maps in multiple languages
You can access the map in Spanish (our default language) like this:

`https://our-maps-server.org/:community_id/maps/:map_id`

and you can access in catalan like this:

`https://our-maps-server.org/ca/:community_id/maps/:map_id`

### With useIntl React hook
```
import { useIntl } from 'react-intl'
const HelloI18nComponent = () => {
  const intl = useIntl()
  return <span>{intl.formatMessage({ defaultMessage: '¿Hola qué tal?'})}</span>
}
```

### With <FormattedMessage /> component
```
import { FormattedMessage } from 'react-intl'
const HelloI18nComponent = () => {
  const intl = useIntl()
  return <span><FormattedMessage defaultMessage='¿Hola qué tal?' /></span>
}
```

### Translation generation
By default you as developer use `useIntl` or `<FormattedMessage />` in your components and set the `defaultMessage` in
**Spanish** because that's our default message.
Then in our `package.json` we have 3 commands `extract:i18n`, `compile:i18n` and `i18n`
Let's explain what do each command:

`extract:i18n` it takes all strings in our components and add to `content/locales/es.json`

`compile:i18n` it takes all JSON files from `content/locales/*.json` in all locales and put on `content/compiled-locales/*.json`

`i18n` is the combination of `extract:i18n` and `compile:i18n`

The files in `content/compiled-locales/*.json` are the final result the user see in the browser. You can see how we load it on `src/pages/_app.tsx` file.

### How to translate from Spanish to other supported language?
You can see the locales we support on `./next.config.js` in  `i18n.locales`. Also you can see there our `i18n.defaultLocale`

If a string is not translated in Catalan it will show in Spanish. This is nice because you can focus on developing your component and later translate it.
Now we don't use any external saas service for managing the translations.

The way we do is to take new added translations in `content/locales/es.json` after you run `yarn extract:i18n`. Put those keys in `content/locales/ca.json` and
translate it to catalan. **IMPORTANT** do NOT change autogenerated **IDs**
### Auto generated translation IDs
React Intl force all translation componenents to have an `id` attribute. So this is wrong
``` javascript
<FormattedMessage defaultMessage='¿Hola qué tal?` />
```
This will **FAIL** in our CI. to fix it you need to run `yarn lint`. This run `ESLint` with `--fix` flag which fix it for us.
Now if you see the componenent again in your editor you'll see ESLint add the `id` prop for us:
``` javascript
<FormattedMessage defaultMessage='¿Hola qué tal?' id="eOuNie" />
```
:warn: **NEVER CHANGE THE IDs MANUALLY**
